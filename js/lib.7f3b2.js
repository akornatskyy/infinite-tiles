(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.d(e,"a",(function(){return r}));var r=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.left=e,this.top=i,this.width=n,this.height=r}return function(t,e,i){e&&n(t.prototype,e)}(t,[{key:"equals",value:function(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height}},{key:"right",get:function(){return this.left+this.width}},{key:"bottom",get:function(){return this.top+this.height}}]),t}()},function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.d(e,"a",(function(){return r}));var r=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=i}return function(t,e,i){e&&n(t.prototype,e)}(t,[{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"scaleAndAdd",value:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}},{key:"lerp",value:function(t,e){return this.x=this.x+(t.x-this.x)*e,this.y=this.y+(t.y-this.y)*e,this}}]),t}()},function(t,e,i){"use strict";i.r(e),i.d(e,"StaggeredTileRenderer",(function(){return h})),i.d(e,"StaggeredMapRenderer",(function(){return a}));var n=i(1);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t}var h=function(){function t(e,i,o){r(this,t),this.viewport=e,this.tile=i,this.bounds=o,this.position=new n.a(this.bounds.left,this.bounds.top)}return s(t,[{key:"draw",value:function(){var t=this.viewport.worldToScreen(this.tile.x,this.tile.y);this.drawTile(t.x+this.position.x,t.y+this.position.y)}}]),t}(),a=function(){function t(e,i){r(this,t),this.map=e,this.tileSize=e.viewport.world.tileSize,this.bounds=e.viewport.bounds,this.renderer=i}return s(t,[{key:"draw",value:function(){this.renderer.begin();for(var t=this.map.viewport.position,e=this.map.tiles,i=e.top;i<=e.bottom;i++)for(var n=i%2?this.tileSize.halfWidth:0,r=e.left;r<=e.right;r++){var o=r*this.tileSize.width+n-t.x;if(!(o+this.tileSize.width<=0||o>=this.bounds.width)){var s=i*this.tileSize.halfHeight-t.y;o+=this.bounds.left,s+=this.bounds.top,this.renderer.drawTile(r,i,o,s)}}var h=this.map.selected;if(h){var a=this.map.viewport.worldToScreen(h.x,h.y);this.renderer.drawSelected(h.x,h.y,a.x,a.y)}this.renderer.end()}}]),t}()},function(t,e,i){"use strict";function n(t){function e(e){if(0!==e.movementX||0!==e.movementY){var i=new Event("mousedrag");i.movementX=e.movementX,i.movementY=e.movementY,t.dispatchEvent(i)}}function i(n){t.removeEventListener("mousemove",e),t.removeEventListener("mouseleave",i)}return t.addEventListener("mousedown",(function(n){t.addEventListener("mousemove",e),t.addEventListener("mouseleave",i)})),t.addEventListener("mouseup",i),t}i.r(e),i.d(e,"default",(function(){return n}))},function(t,e,i){"use strict";i.r(e),i.d(e,"moverMixin",(function(){return l}));var n=i(1);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,i){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=function(t){return function(){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}(this,h(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(e,t),function(t,e,i){e&&o(t.prototype,e)}(e,[{key:"moveTo",value:function(t,e,i){var r=2<arguments.length&&void 0!==i?i:0;this.target=t,this.duration=e,this.elapsed=r,this.moving=!0,this.targetPosition=new n.a(this.bounds.left,this.bounds.top).add(this.viewport.worldToScreen(t.x,t.y)).sub(this.viewport.worldToScreen(this.tile.x,this.tile.y))}},{key:"update",value:function(t){if(s(h(e.prototype),"update",this)&&s(h(e.prototype),"update",this).call(this,t),this.moving&&(this.elapsed+=t,!(this.elapsed<=0))){this.position.x=this.bounds.left,this.position.y=this.bounds.top;var i=this.elapsed/this.duration;i<1?this.position.lerp(this.targetPosition,i):(this.tile=this.target,this.targetPosition=null,this.target=null,this.moving=!1)}}}]),e}()}},function(t,e,i){"use strict";i.r(e);var n=i(0);function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.limit=e,this.clear()}return function(t,e,i){e&&r(t.prototype,e)}(t,[{key:"clear",value:function(){this.items=new Map,this.size=0,this.older=null,this.newer=null}},{key:"get",value:function(t){var e=this.items.get(t);return e?(this.used(t,e),e.value):null}},{key:"peek",value:function(t){var e=this.items.get(t);return e?e.value:null}},{key:"has",value:function(t){return void 0!==this.items.get(t)}},{key:"touch",value:function(t){var e=this.items.get(t);return!!e&&(this.used(t,e),!0)}},{key:"set",value:function(t,e){var i=this.items.get(t);i||(i={},this.items.set(t,i),this.size<this.limit?this.size++:this.evict()),this.used(t,i),i.value=e}},{key:"remove",value:function(t){var e=this.items.get(t);if(!e)return null;this.size--,this.items.delete(t);var i=e.older,n=e.newer;return this.older===t?this.older=n:this.items.get(i).newer=n,this.newer===t?this.newer=i:this.items.get(n).older=i,e.value}},{key:"used",value:function(t,e){if(this.newer!==t){var i=this.items.get(e.older),n=this.items.get(e.newer);i&&(i.newer=e.newer),n&&(n.older=e.older);var r=this.items.get(this.newer);r&&(r.newer=t,e.older=this.newer),this.older?this.older===t&&(this.older=e.newer):this.older=t,this.newer=t,e.newer=null}}},{key:"evict",value:function(){var t=this.older;if(t){var e=this.items.get(t);this.items.delete(t),this.older=e.newer}}},{key:"toString",value:function(){for(var t=[],e=this.older;e;)t.push(e),e=this.items.get(e).newer;return t.join(" < ")}}]),t}();function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e){return(0<=e?"S"+e:"N"+-e)+(0<=t?"E"+t:"W"+-t)}var a=new n.a,l=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.api=e,this.margin=i,this.cache=new o(n),this.tiles=a,this.fetching=new Map,this.ref=0,this.refs=new Map,e.on("open",this.onopen.bind(this)),e.on("tiles",this.ontiles.bind(this))}return function(t,e,i){e&&s(t.prototype,e)}(t,[{key:"get",value:function(t,e){var i=h(t,e);return this.cache.peek(i)}},{key:"preload",value:function(t){if(!t.equals(this.tiles)&&(this.tiles=t,this.api.isReady())){for(var e=[],i=[],n=t.left-this.margin.width,r=t.right+this.margin.width,o=t.top-this.margin.height,s=t.bottom+this.margin.height,a=o;a<=s;a++)for(var l=n;l<=r;l++){var u=h(l,a);this.cache.touch(u)||this.fetching.has(u)||(this.fetching.set(u),e.push(u),i.push(l-n),i.push(a-o))}var f={t:"tiles",area:[n,o,r-n,s-o]};0<e.length&&(this.refs.set(this.ref,e),f.ref=this.ref,f.coords=i,this.ref<127?this.ref++:this.ref=0),this.api.send(f)}}},{key:"onopen",value:function(){this.cache.clear(),this.tiles=a,this.fetching.clear(),this.ref=0,this.refs.clear()}},{key:"ontiles",value:function(t){var e=this,i=this.refs.get(t.ref);if(i){this.refs.delete(t.ref);var n=t.data;i.length===n.length&&i.forEach((function(t,i){e.cache.set(t,n[i]),e.fetching.delete(t)}))}}}]),t}(),u=i(1);function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.world=e,this.bounds=i,this.position=new u.a}return function(t,e,i){e&&f(t.prototype,e)}(t,[{key:"screenToWorld",value:function(t,e){return this.world.screenToWorld(t-this.bounds.left+this.position.x,e-this.bounds.top+this.position.y)}},{key:"worldToScreen",value:function(t,e){var i=this.world.worldToScreen(t,e);return{x:i.x+this.bounds.left-this.position.x,y:i.y+this.bounds.top-this.position.y}}},{key:"tiles",value:function(){var t=new n.a(this.position.x,this.position.y,this.bounds.width,this.bounds.height);return this.world.screenToWorldRectangle(t)}}]),t}();function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var v=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tileSize=e}return function(t,e,i){e&&d(t.prototype,e)}(t,[{key:"worldToScreen",value:function(t,e){return{x:t*this.tileSize.width+(e%2?this.tileSize.halfWidth:0),y:e*this.tileSize.halfHeight}}},{key:"screenToWorld",value:function(t,e){t=Math.round(t),e=1+Math.round(e);var i=Math.floor(t/this.tileSize.width),n=2*Math.floor(e/this.tileSize.height);return t=Math.floor(t%this.tileSize.width),t+=t<0?this.tileSize.halfWidth:-this.tileSize.halfWidth,e=Math.floor(e%this.tileSize.height),e+=e<0?this.tileSize.halfHeight:-this.tileSize.halfHeight,t<0?e<0?-2*(e+this.tileSize.halfHeight)>t&&(i--,n--):2*(e-this.tileSize.halfHeight)>t&&(i--,n++):e<0?2*(e+this.tileSize.halfHeight)<=t&&n--:-2*(e-this.tileSize.halfHeight)<=t&&n++,{x:i,y:n}}},{key:"screenToWorldRectangle",value:function(t){var e=this.screenToWorldLeftTop(t.left,t.top),i=this.screenToWorldRightBottom(t.right,t.bottom);return new n.a(e.x,e.y,i.x-e.x,i.y-e.y)}},{key:"screenToWorldLeftTop",value:function(t,e){var i=Math.floor(t/this.tileSize.width),n=2*Math.floor(e/this.tileSize.height);return t%=this.tileSize.width,t+=t<0?this.tileSize.halfWidth:-this.tileSize.halfWidth,e%=this.tileSize.height,e+=e<0?this.tileSize.halfHeight:-this.tileSize.halfHeight,t<0?e<0?(i--,n--):i--:e<0&&n--,{x:i,y:n}}},{key:"screenToWorldRightBottom",value:function(t,e){var i=Math.floor(t/this.tileSize.width),n=2*Math.floor(e/this.tileSize.height);return 0==(t%=this.tileSize.width)&&i--,0==(e%=this.tileSize.height)?n--:0<(e+=e<0?this.tileSize.halfHeight:-this.tileSize.halfHeight)&&n++,{x:i,y:n}}}]),t}();function p(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.d(e,"default",(function(){return y}));var y=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewport=new c(new v(i),n),this.tiles=this.viewport.tiles();var r={width:Math.ceil(1.2*this.tiles.width),height:Math.ceil(1.2*this.tiles.height)},o=Math.ceil(r.width*r.height*16);this.storage=new l(e,r,o)}return function(t,e,i){e&&p(t.prototype,e)}(t,[{key:"update",value:function(){this.tiles=this.viewport.tiles(),this.storage.preload(this.tiles)}}]),t}()},,,function(t,e,i){i(3),i(5),i(4),t.exports=i(2)}]]);